# -*- coding: utf-8 -*-
"""
Created on Thu Aug 11 18:12:37 2016

@author: Eddy_zheng
"""

import matplotlib.pyplot as plt
import matplotlib.patches as patches
import numpy as np
def build_plot_para(brake_boat):
    X = []
    Y = []
    li = []
    wi = []
    N = len(brake_boat)
    for k, v in brake_boat.items():
        li.append(v[1][0])
        wi.append(v[1][1])
        X.append(v[0][0])
        Y.append(v[0][1])
    return np.array(X), np.array(Y), np.array(li), np.array(wi), N

def plot_example(X, Y, li, wi, N, brake_num=0):
    fig1 = plt.figure()
    ax1 = fig1.add_subplot(111, aspect='equal')
    # ax1 = plt.subplot(111)
    # 设置坐标轴范围，不然默认就是0-1之间x是（0,280），y是（0,34）
    ax1.axis([0, 280, 0, 34])

    colour = ['red', 'green', 'white', 'yellow', 'blue', 'black']
    for i in range(N):
        ax1.add_patch(
            patches.Rectangle(
                (X[i], Y[i]),  # (x,y)
                li[i],  # width
                wi[i],  # height
                color='black',
                fill=False
            )
        )

    # fig1.savefig('rect_{}.png'.format(brake_num), dpi=90, bbox_inches='tight')
    plt.show()
    # ax1.add_patch(
    #
    #     patches.Rectangle(
    #         (0.1, 0.1),   # (x,y)
    #         0.5,          # width
    #         0.5,          # height
    #     )
    #
    # )
    #
    #
    # ax1.add_patch(
    #     patches.Rectangle(
    #         (0.7, 0.7),   # (x,y)
    #         0.5,          # width
    #         0.5,          # height
    #     )
    # )
    # plt.gcf().set_size_inches(18, 10)
    # plt.show()
    # fig1.savefig('rect1.png', dpi=90, bbox_inches='tight')


if __name__ == '__main__':
    wait_list = [(119.53, 22.5),
                 (99.3, 16.92),
                 (85.5, 16.3),
                 (110, 17.2),
                 (110, 19.22),
                 (119.53, 22.5),
                 (99.3, 16.92),
                 (99.3, 16.92),
                 (85.5, 16.3),
                 (110, 17.2),
                 (110, 17.2),
                 (119.53, 22.5)]
    wait_list = wait_list[0:6]

    N = len(wait_list)
    W = 34
    L = 280

    # li=np.array([each[0] for each in wait_list])/L
    # wi=np.array([each[1] for each in wait_list])/W
    #
    # X=np.array([129.42922238, 177.63115518, 172.31146189, 168.24637649,
    #         90.59384038, 132.09799331])/L
    # Y=np.array([ 2.61286949, 12.38680287, 14.50734225, 15.76862964,  8.08009241,10.86250473])/W
    ##############################

    ##绘制单个闸室的图
    # # 判断是否有问题
    # brake_boat = {
    #     16: [(0, 0), (93.87, 16.06)],
    #     10: [(93.87, 0), (92.92, 22.13)],
    #     18: [(0, 16.06), (91.66, 17.91)],
    #     7: [(186.79000000000002, 0), (92.96, 21.72)]
    # }
    #
    # X = []
    # Y = []
    # li = []
    # wi = []
    # N = len(brake_boat)
    # for k, v in brake_boat.items():
    #     li.append(v[1][0])
    #     wi.append(v[1][1])
    #     X.append(v[0][0])
    #     Y.append(v[0][1])
    # plot_example(np.array(X), np.array(Y), np.array(li), np.array(wi), N)

    ##绘制多个闸室的图
    all_brake_boat={'0':
        {'brake_boat': {22: [(0, 0), (87.0, 15.0)], 38: [(0, 15.0), (93.0, 14.0)], 20: [(87.0, 0), (85.0, 14.0)],
                          26: [(93.0, 15.0), (75.0, 14.0)], 62: [(172.0, 0), (92.0, 15.0)],
                          49: [(168.0, 15.0), (92.0, 17.0)]}},
                    '1': {
        'brake_boat': {53: [(0, 0), (130.0, 17.0)], 59: [(0, 17.0), (78.0, 14.0)], 5: [(130.0, 0), (130.0, 17.0)],
                       23: [(78.0, 17.0), (92.0, 15.0)], 55: [(170.0, 17.0), (87.0, 15.0)]}},
                    '2': {
        'brake_boat': {57: [(0, 0), (105.0, 17.0)], 17: [(0, 17.0), (92.0, 15.0)], 63: [(105.0, 0), (75.0, 13.0)],
                       19: [(92.0, 17.0), (85.0, 15.0)], 48: [(177.0, 17.0), (87.0, 15.0)],
                       40: [(180.0, 0), (80.0, 14.0)]}}}
    all_brake_boat ={
        0: {'brake_boat': {55: [(0, 0), (87.0, 15.0)], 53: [(0, 15.0), (130.0, 17.0)], 23: [(87.0, 0), (92.0, 15.0)],
                        21: [(130.0, 15.0), (130.0, 17.0)], 19: [(179.0, 0), (85.0, 15.0)]},
         'best_use_rate': 0.8802521008403361}, 1: {
        'brake_boat': {7: [(0, 0), (92.0, 15.0)], 5: [(0, 15.0), (130.0, 17.0)], 37: [(130.0, 15.0), (130.0, 16.0)],
                       30: [(92.0, 0), (92.0, 15.0)], 40: [(184.0, 0), (80.0, 14.0)]},
        'best_use_rate': 0.8581932773109243}, 2: {
        'brake_boat': {62: [(0, 0), (92.0, 15.0)], 64: [(0, 15.0), (80.0, 14.0)], 34: [(80.0, 15.0), (92.0, 17.0)],
                       65: [(172.0, 15.0), (90.0, 17.0)], 58: [(92.0, 0), (85.0, 14.0)],
                       22: [(177.0, 0), (87.0, 15.0)]}, 'best_use_rate': 0.8496848739495798}}
    all_brake_boat={'0': {'brake_boat': {7: [(0, 0), (92.0, 15.0)], 53: [(0, 15.0), (130.0, 17.0)], 5: [(130.0, 15.0), (130.0, 17.0)],
                          29: [(92.0, 0), (80.0, 14.0)], 62: [(172.0, 0), (92.0, 15.0)]}}, '1': {
        'brake_boat': {48: [(0, 0), (87.0, 15.0)], 37: [(0, 15.0), (130.0, 16.0)], 21: [(130.0, 15.0), (130.0, 17.0)],
                       19: [(87.0, 0), (85.0, 15.0)], 25: [(172.0, 0), (85.0, 14.0)]}}, '2': {
        'brake_boat': {23: [(0, 0), (92.0, 15.0)], 0: [(0, 15.0), (105.0, 16.0)], 55: [(92.0, 0), (87.0, 15.0)],
                       59: [(105.0, 15.0), (78.0, 14.0)], 20: [(179.0, 0), (85.0, 14.0)],
                       40: [(183.0, 15.0), (80.0, 14.0)]}}}

    all_brake_boat ={'0': {'brake_boat': {19: [(0, 0), (85.0, 15.0)], 65: [(0, 15.0), (90.0, 17.0)], 48: [(85.0, 0), (87.0, 15.0)],
                          62: [(90.0, 15.0), (92.0, 15.0)], 30: [(172.0, 0), (92.0, 15.0)],
                          42: [(182.0, 15.0), (75.0, 14.0)]}}, '1': {
        'brake_boat': {46: [(0, 0), (89.0, 15.0)], 37: [(0, 15.0), (130.0, 16.0)], 53: [(130.0, 15.0), (130.0, 17.0)],
                       29: [(89.0, 0), (80.0, 14.0)], 23: [(169.0, 0), (92.0, 15.0)]}}, '2': {
        'brake_boat': {5: [(0, 0), (130.0, 17.0)], 55: [(0, 17.0), (87.0, 15.0)], 21: [(130.0, 0), (130.0, 17.0)],
                       25: [(87.0, 17.0), (85.0, 14.0)], 24: [(172.0, 17.0), (87.0, 14.0)]}}}

    all_brake_boat={'0': {'brake_boat': {21: [(0, 0), (130.0, 17.0)], 38: [(0, 17.0), (93.0, 14.0)], 37: [(130.0, 0), (130.0, 16.0)],
                          35: [(93.0, 17.0), (87.0, 14.0)], 59: [(180.0, 17.0), (78.0, 14.0)]}}, '1': {
        'brake_boat': {47: [(0, 0), (88.0, 17.0)], 24: [(0, 17.0), (87.0, 14.0)], 17: [(88.0, 0), (92.0, 15.0)],
                       41: [(88.0, 15.0), (95.0, 17.0)], 64: [(180.0, 0), (80.0, 14.0)],
                       44: [(183.0, 15.0), (80.0, 14.0)]}}, '2': {
        'brake_boat': {30: [(0, 0), (92.0, 15.0)], 5: [(0, 15.0), (130.0, 17.0)], 54: [(130.0, 15.0), (110.0, 17.0)],
                       58: [(92.0, 0), (85.0, 14.0)], 22: [(177.0, 0), (87.0, 15.0)]}}, '3': {
        'brake_boat': {10: [(0, 0), (95.0, 16.0)], 18: [(0, 16.0), (105.0, 16.0)], 25: [(95.0, 0), (85.0, 14.0)],
                       26: [(105.0, 16.0), (75.0, 14.0)], 42: [(180.0, 0), (75.0, 14.0)],
                       63: [(180.0, 16.0), (75.0, 13.0)]}}, '4': {
        'brake_boat': {62: [(0, 0), (92.0, 15.0)], 2: [(0, 15.0), (100.0, 17.0)], 43: [(92.0, 0), (79.0, 13.0)],
                       53: [(100.0, 15.0), (130.0, 17.0)], 23: [(171.0, 0), (92.0, 15.0)]}}}

    all_brake_boat ={'0': {'brake_boat': {47: [(0, 0), (88.0, 17.0)], 22: [(0, 17.0), (87.0, 15.0)], 65: [(88.0, 0), (90.0, 17.0)],
                          20: [(87.0, 17.0), (85.0, 14.0)], 19: [(178.0, 0), (85.0, 15.0)],
                          46: [(172.0, 17.0), (89.0, 15.0)]}}, '1': {
        'brake_boat': {23: [(0, 0), (92.0, 15.0)], 5: [(0, 15.0), (130.0, 17.0)], 7: [(92.0, 0), (92.0, 15.0)],
                       37: [(130.0, 15.0), (130.0, 16.0)], 64: [(184.0, 0), (80.0, 14.0)]}}, '2': {
        'brake_boat': {30: [(0, 0), (92.0, 15.0)], 53: [(0, 15.0), (130.0, 17.0)], 21: [(130.0, 15.0), (130.0, 17.0)],
                       38: [(92.0, 0), (93.0, 14.0)], 26: [(185.0, 0), (75.0, 14.0)]}}}

    all_brake_boat=    {
      '0': {'brake_boat': {23: [(0, 0), (92.0, 15.0)], 34: [(0, 15.0), (92.0, 17.0)], 49: [(92.0, 0), (92.0, 17.0)],
                          19: [(92.0, 17.0), (85.0, 15.0)], 55: [(177.0, 17.0), (87.0, 15.0)],
                          32: [(184.0, 0), (80.0, 14.0)]}}, '1': {
        'brake_boat': {30: [(0, 0), (92.0, 15.0)], 21: [(0, 15.0), (130.0, 17.0)], 53: [(130.0, 15.0), (130.0, 17.0)],
                       22: [(92.0, 0), (87.0, 15.0)], 64: [(179.0, 0), (80.0, 14.0)]}}, '2': {
        'brake_boat': {5: [(0, 0), (130.0, 17.0)], 62: [(0, 17.0), (92.0, 15.0)], 37: [(130.0, 0), (130.0, 16.0)],
                       40: [(92.0, 17.0), (80.0, 14.0)], 17: [(172.0, 17.0), (92.0, 15.0)]}}}

    all_brake_boat={
    '0': {'brake_boat': {47: [(0, 0), (88.0, 17.0)], 22: [(0, 17.0), (87.0, 15.0)], 65: [(88.0, 0), (90.0, 17.0)],
                          20: [(87.0, 17.0), (85.0, 14.0)], 19: [(178.0, 0), (85.0, 15.0)],
                          46: [(172.0, 17.0), (89.0, 15.0)]}}, '1': {
        'brake_boat': {23: [(0, 0), (92.0, 15.0)], 5: [(0, 15.0), (130.0, 17.0)], 7: [(92.0, 0), (92.0, 15.0)],
                       37: [(130.0, 15.0), (130.0, 16.0)], 64: [(184.0, 0), (80.0, 14.0)]}}, '2': {
        'brake_boat': {30: [(0, 0), (92.0, 15.0)], 53: [(0, 15.0), (130.0, 17.0)], 21: [(130.0, 15.0), (130.0, 17.0)],
                       38: [(92.0, 0), (93.0, 14.0)], 26: [(185.0, 0), (75.0, 14.0)]}}}

    all_brake_boat={
    '0': {'brake_boat': {41: [(0, 0), (95.0, 17.0)], 2: [(0, 17.0), (100.0, 17.0)], 32: [(95.0, 0), (80.0, 14.0)],
                          0: [(100.0, 17.0), (105.0, 16.0)]}}, '1': {
        'brake_boat': {21: [(0, 0), (130.0, 17.0)], 16: [(0, 17.0), (100.0, 17.0)], 24: [(130.0, 0), (87.0, 14.0)],
                       13: [(130.0, 14.0), (110.0, 18.0)]}},
     '2': {'brake_boat': {53: [(0, 0), (130.0, 17.0)], 12: [(0, 17.0), (105.0, 17.0)], 5: [(130.0, 0), (130.0, 17.0)]}},
     '3': {'brake_boat': {47: [(0, 0), (88.0, 17.0)], 19: [(0, 17.0), (85.0, 15.0)], 49: [(88.0, 0), (92.0, 17.0)],
                          18: [(85.0, 17.0), (105.0, 16.0)]}}, '4': {
        'brake_boat': {45: [(0, 0), (77.0, 14.0)], 58: [(0, 14.0), (85.0, 14.0)], 64: [(77.0, 0), (80.0, 14.0)],
                       11: [(85.0, 14.0), (110.0, 20.0)]}}, '5': {
        'brake_boat': {6: [(0, 0), (108.0, 18.0)], 59: [(0, 18.0), (78.0, 14.0)], 7: [(108.0, 0), (92.0, 15.0)],
                       65: [(108.0, 15.0), (90.0, 17.0)]}}, '6': {
        'brake_boat': {1: [(0, 0), (110.0, 18.0)], 20: [(0, 18.0), (85.0, 14.0)], 27: [(110.0, 0), (100.0, 18.0)],
                       38: [(85.0, 18.0), (93.0, 14.0)]}}, '7': {
        'brake_boat': {51: [(0, 0), (110.0, 18.0)], 46: [(0, 18.0), (89.0, 15.0)], 9: [(110.0, 0), (100.0, 18.0)],
                       37: [(89.0, 18.0), (130.0, 16.0)]}}, '8': {
        'brake_boat': {30: [(0, 0), (92.0, 15.0)], 4: [(0, 15.0), (109.0, 18.0)], 56: [(109.0, 15.0), (110.0, 18.0)],
                       55: [(92.0, 0), (87.0, 15.0)]}}, '9': {
        'brake_boat': {43: [(0, 0), (79.0, 13.0)], 22: [(0, 13.0), (87.0, 15.0)], 23: [(87.0, 13.0), (92.0, 15.0)],
                       25: [(179.0, 13.0), (85.0, 14.0)]}}, '10': {
        'brake_boat': {57: [(0, 0), (105.0, 17.0)], 63: [(0, 17.0), (75.0, 13.0)], 54: [(105.0, 0), (110.0, 17.0)],
                       35: [(75.0, 17.0), (87.0, 14.0)], 50: [(162.0, 17.0), (105.0, 16.0)]}}, '11': {
        'brake_boat': {61: [(0, 0), (107.0, 17.0)], 33: [(0, 17.0), (107.0, 17.0)], 15: [(107.0, 0), (108.0, 18.0)],
                       17: [(107.0, 18.0), (92.0, 15.0)]}}, '12': {
        'brake_boat': {52: [(0, 0), (100.0, 16.0)], 29: [(0, 16.0), (80.0, 14.0)], 62: [(100.0, 0), (92.0, 15.0)],
                       31: [(80.0, 16.0), (95.0, 16.0)], 34: [(175.0, 16.0), (92.0, 17.0)]}}, '13': {
        'brake_boat': {8: [(0, 0), (110.0, 18.0)], 42: [(0, 18.0), (75.0, 14.0)], 3: [(110.0, 0), (106.0, 18.0)],
                       40: [(75.0, 18.0), (80.0, 14.0)]}}, '14': {
        'brake_boat': {60: [(0, 0), (100.0, 17.0)], 36: [(0, 17.0), (106.0, 17.0)], 44: [(100.0, 0), (80.0, 14.0)],
                       39: [(106.0, 17.0), (100.0, 17.0)]}}, '15': {
        'brake_boat': {28: [(0, 0), (80.0, 14.0)], 26: [(0, 14.0), (75.0, 14.0)], 14: [(80.0, 0), (110.0, 18.0)],
                       10: [(80.0, 18.0), (95.0, 16.0)], 48: [(190.0, 0), (87.0, 15.0)]}}}

    all_brake_boat={
    0: {'brake_boat': {0: [(0, 0), (95.0, 16.0)], 1: [(95.0, 0), (92.0, 17.0)]}, 'best_use_rate': 0.3239495798319328},
     1: {'brake_boat': {2: [(0, 0), (88.0, 17.0)]}, 'best_use_rate': 0.15714285714285714}}

    all_brake_boat = {'0': {
        'brake_boat': {61: [(0, 0), (107.0, 17.0)], 48: [(0, 17.0), (87.0, 15.0)], 63: [(107.0, 0), (75.0, 13.0)],
                       31: [(87.0, 17.0), (95.0, 16.0)]}}, '1': {
        'brake_boat': {6: [(0, 0), (108.0, 18.0)], 15: [(108.0, 0), (108.0, 18.0)], 55: [(0, 18.0), (87.0, 15.0)],
                       50: [(108.0, 18.0), (105.0, 16.0)]}}, '2': {
        'brake_boat': {16: [(0, 0), (100.0, 17.0)], 60: [(0, 17.0), (100.0, 17.0)], 30: [(100.0, 0), (92.0, 15.0)],
                       26: [(100.0, 17.0), (75.0, 14.0)]}}, '3': {
        'brake_boat': {8: [(0, 0), (110.0, 18.0)], 64: [(0, 18.0), (80.0, 14.0)], 45: [(110.0, 0), (77.0, 14.0)],
                       20: [(80.0, 18.0), (85.0, 14.0)], 7: [(187.0, 0), (92.0, 15.0)]}}, '4': {
        'brake_boat': {57: [(0, 0), (105.0, 17.0)], 52: [(0, 17.0), (100.0, 16.0)], 38: [(105.0, 0), (93.0, 14.0)],
                       43: [(100.0, 17.0), (79.0, 13.0)], 39: [(179.0, 17.0), (100.0, 17.0)]}}, '5': {
        'brake_boat': {34: [(0, 0), (92.0, 17.0)], 14: [(92.0, 0), (110.0, 18.0)], 10: [(92.0, 18.0), (95.0, 16.0)],
                       42: [(0, 17.0), (75.0, 14.0)]}}, '6': {
        'brake_boat': {53: [(0, 0), (130.0, 17.0)], 18: [(0, 17.0), (105.0, 16.0)], 40: [(130.0, 0), (80.0, 14.0)],
                       36: [(105.0, 17.0), (106.0, 17.0)]}}, '7': {
        'brake_boat': {59: [(0, 0), (78.0, 14.0)], 29: [(0, 14.0), (80.0, 14.0)], 65: [(80.0, 14.0), (90.0, 17.0)],
                       49: [(170.0, 14.0), (92.0, 17.0)], 32: [(78.0, 0), (80.0, 14.0)]}}, '8': {
        'brake_boat': {41: [(0, 0), (95.0, 17.0)], 4: [(95.0, 0), (109.0, 18.0)], 19: [(0, 17.0), (85.0, 15.0)],
                       23: [(95.0, 18.0), (92.0, 15.0)]}}, '9': {
        'brake_boat': {56: [(0, 0), (110.0, 18.0)], 17: [(0, 18.0), (92.0, 15.0)], 13: [(110.0, 0), (110.0, 18.0)],
                       62: [(92.0, 18.0), (92.0, 15.0)]}}, '10': {
        'brake_boat': {51: [(0, 0), (110.0, 18.0)], 28: [(0, 18.0), (80.0, 14.0)], 25: [(110.0, 0), (85.0, 14.0)],
                       2: [(110.0, 14.0), (100.0, 17.0)]}}, '11': {
        'brake_boat': {11: [(0, 0), (110.0, 20.0)], 0: [(110.0, 0), (105.0, 16.0)], 47: [(110.0, 16.0), (88.0, 17.0)],
                       24: [(0, 20.0), (87.0, 14.0)]}}, '12': {
        'brake_boat': {54: [(0, 0), (110.0, 17.0)], 35: [(0, 17.0), (87.0, 14.0)], 27: [(110.0, 0), (100.0, 18.0)],
                       58: [(110.0, 18.0), (85.0, 14.0)]}}, '13': {
        'brake_boat': {21: [(0, 0), (130.0, 17.0)], 22: [(0, 17.0), (87.0, 15.0)], 46: [(130.0, 0), (89.0, 15.0)],
                       3: [(130.0, 15.0), (106.0, 18.0)]}}, '14': {
        'brake_boat': {9: [(0, 0), (100.0, 18.0)], 5: [(100.0, 0), (130.0, 17.0)], 37: [(0, 18.0), (130.0, 16.0)]}},
                      '15': {'brake_boat': {1: [(0, 0), (110.0, 18.0)], 12: [(110.0, 0), (105.0, 17.0)],
                                            33: [(110.0, 17.0), (107.0, 17.0)], 44: [(0, 18.0), (80.0, 14.0)]}}}

    for brake_num,e_brake_boat in all_brake_boat.items():


        X, Y, li_e, wi_e, N_e=build_plot_para(e_brake_boat['brake_boat'])
        plot_example(X, Y, li_e, wi_e,N_e)